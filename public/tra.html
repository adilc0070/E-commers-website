<!-- else if (format === 'excel') {
    // Generate and send an Excel report
    const workbook = new ExcelJS.Workbook();
    const worksheet = workbook.addWorksheet('Sales Report');

    // Add data to the Excel worksheet (customize as needed)
    worksheet.columns = [
      { header: 'Order ID', key: 'orderId', width: 8 },
      { header: 'Product Name', key: 'productName', width: 50 },
      { header: 'Qty', key: 'qty', width: 5 },
      { header: 'Date', key: 'date', width: 12 },
      { header: 'Customer', key: 'customer', width: 15 },
      { header: 'Total Amount', key: 'totalAmount', width: 12 },
    ];
    // Add rows from the reportData to the worksheet
    orders.forEach((data) => {
      worksheet.addRow({
        orderId: data._id,
        productName: data.products.productDetails.name,
        qty: data.products.count,
        date: data.date.toLocaleDateString('en-US', { year:
          'numeric', month: 'short', day: '2-digit' }).replace(/\//g,
          '-'),
        customer: data.deliveryDetails.fullName,
        totalAmount: data.products.totalPrice,
      });
    });

    res.setHeader('Content-Type', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
    res.setHeader('Content-Disposition', `attachment; filename=${duration}_sales_report.xlsx`);
    const excelBuffer = await workbook.xlsx.writeBuffer();
    res.end(excelBuffer); -->

  